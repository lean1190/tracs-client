<ion-view cache-view="false" view-title="Perfil de {{vm.patient.name}}">
    <ion-content>
        <ion-tabs class="tabs-striped tabs-top patient-tabs">

            <ion-tab title="GENERAL" on-select="vm.changeToGeneralTab()">
                <div class="general-tab">
                    <div class="image-name-wrapper" ng-show="vm.editOn === false">
                        <div class="image">
                            <img ng-src="{{vm.patient.picture}}" alt="{{vm.patient.name}}">
                        </div>
                        <div class="name">

                            <h4>{{ vm.patient.name }}</h4>

                        </div>
                    </div>
                    <div class="info" ng-show="vm.editOn === false">
                        <div><strong>DNI</strong>
                            <h4>{{vm.patient.DNI}}</h4>
                        </div>
                        <div><strong>Teléfono</strong>
                            <h4> {{ vm.patient.phoneNumber || "Aún no tiene teléfono" }} </h4>
                        </div>
                        <div><strong>Nacido el</strong>
                            <h4>{{ vm.patient.birthDate | date:"dd/MM/yyyy" }}</h4>
                        </div>
                        <div><strong>Descripción General</strong>
                            <h4>{{ vm.patient.generalDescription || "Aún no hay descripción" }}</h4>
                        </div>
                    </div>

                    <div class="info-edit" ng-show="vm.editOn === true " >

                        <label class="item item-input item-floating-label">
                            <span class="input-label required-field">Nombre</span>
                            <input type="text" ng-model="vm.patient.name" placeholder="Nombre *" required>
                        </label>

                        <label class="item item-input item-floating-label">
                            <span class="input-label required-field">DNI</span>
                            <input type="text" ng-model="vm.patient.DNI" placeholder="DNI *" required>
                        </label>

                        <label class="item item-input item-floating-label">
                            <span class="input-label">Teléfono</span>
                            <input type="text" ng-model="vm.patient.phoneNumber" placeholder="Télefono" required>
                        </label>

                        <label class="item item-input item-floating-label">
                            <span class="input-label required-field">Fecha de nacimiento</span>
                            <input type="text" ng-model="vm.patient.birthDate" placeholder="Fecha de Nacimiento *" onfocus="(this.type='date')" onblur="(this.type='text')">
                        </label>

                        <label class="item item-input item-floating-label">
                            <span class="input-label">Descripción General</span>
                            <input type="text" ng-model="vm.patient.generalDescription" placeholder="Descripción General" required>
                        </label>
                    </div>
                </div>

            </ion-tab>

            <ion-tab title="OPINIONES" on-select="vm.changeToOpinionsTab()" hidden="!vm.profile.isParent">
                <div class="opinions-tab">
                    <div class="add-opinion list">
                        <textarea ng-model="vm.patientOpinion" placeholder="Mi opinión"></textarea>
                        <!--<label class="item item-input item-floating-label">
                            <span class="input-label">Mi opinión</span>
                            <input type="text" ng-model="vm.patientOpinion" placeholder="Mi opinión" />
                        </label>-->
                    </div>

                    <h4 ng-if="vm.patientOpinions.length">Lo que opinan los participantes</h4>
                    <h4 ng-if="!vm.patientOpinions.length">Aún no hay opiniones</h4>

                    <div class="others-opinion list" ng-repeat="opinion in vm.patientOpinions" ng-show="opinion.latestPatientOpinion">
                        <a class="item item-avatar" href="#">
                            <img ng-src="{{opinion.user.picture}}">
                            <h2>{{ opinion.user.name }} <span class="date">dijo el {{ opinion.latestPatientOpinion.date | date:"dd/MM/yyyy" }}</h2>
                            <p>{{ opinion.latestPatientOpinion.description }}</p>
                        </a>
                    </div>
                </div>
            </ion-tab>

            <ion-tab title="CONTACTO" on-select="vm.changeToContactInfoTab()">

                <div class="contactInfo-tab" ng-show="vm.patient.contactInfo">
                    <div class="contactInfo" ng-show="vm.editOn === false">
                            <div><strong>Nombre</strong>
                                <h4>{{vm.patient.contactInfo.name}}</h4>
                            </div>
                            <div><strong>Dirección</strong>
                                <h4> {{ vm.patient.contactInfo.address }} </h4>
                            </div>
                            <div><strong>Ciudad</strong>
                                <h4>{{ vm.patient.contactInfo.city}} </h4>
                            </div>
                    </div>
                    <div class="contactInfo-edit" ng-show="vm.editOn === true">

                        <label class="item item-input item-floating-label">
                            <span class="input-label required-field">Nombre</span>
                            <input type="text" ng-model="vm.patient.contactInfo.name" placeholder="Nombre *" required>
                        </label>
                        <label class="item item-input item-floating-label">
                            <span class="input-label required-field">Dirección</span>
                            <input type="text" ng-model="vm.patient.contactInfo.address" placeholder="DIrección *" required>
                        </label>
                        <label class="item item-input item-floating-label">
                            <span class="input-label required-field">Ciudad</span>
                            <input type="text" ng-model="vm.patient.contactInfo.city" placeholder="Ciudad *" required>
                        </label>

                    </div>
                </div>

                <div class="contactInfoEmpty-tab" ng-show="!vm.patient.contactInfo">

                    <h3>El paciente aun no tiene definida su información de contacto.</h3>
                    <a ui-sref="app.patientContactInfoCreate" class="floating-button">
                        <button class="button button-balanced">+</button>
                    </a>

                </div>

            </ion-tab>

        </ion-tabs>
    </ion-content>

</ion-view>
